<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MyBook</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
        }

        .checkout-container {
            max-width: 900px;
            margin: 40px auto;
            padding: 30px;
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        .cart-summary {
            background-color: #f1f3f5;
            border-radius: 10px;
            padding: 20px;
        }

        .cart-item img {
            width: 60px;
            height: 80px;
            object-fit: cover;
            border-radius: 6px;
        }

        .cart-item {
            display: flex;
            align-items: center;
            gap: 15px;
            border-bottom: 1px solid #ddd;
            padding: 10px 0;
        }
    </style>
</head>

<body>
    <nav class="navbar navbar-expand-lg bg-body-tertiary shadow-sm">
        <div class="container-fluid d-flex align-items-center justify-content-between px-5">
            <a class="navbar-brand fw-bold" href="index.html">
                <img src="https://th.bing.com/th/id/OIP.sZ7AIaM8oYEvDNuK4WOSaQHaHa?w=205&h=205&c=7&r=0&o=7&pid=1.7&rm=3"
                    style="height: 40px; width: auto; margin-right: 8px;">MyBook</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <a href="index.html" class="btn btn-dark me-2 active">Home</a>
                    <a href="produk.html" class="btn btn-dark me-2 active">Produk</a>
                    <li class="nav-item"><a class="nav-link" href="#">Keranjang</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <!--container checkout-->
    <div class="checkout-container">
        <div class="row g-4">
            <div class="col-md-6">
                <h4 class="mb-3">Ringkasan Belanja</h4>
                <div id="cartSummary" class="cart-summary">
                    <p>Memuat Keranjang...</p>
                </div>
                <h5 class="mt-3">Total : Rp <span id="checkoutTotal">o</span></h5>
            </div>

            <div class="col-md-6">
                <h4 class="mb-3">Data Pembeli</h4>
                <form id="checkoutForm" onsubmit="submitCheckout(event)" novalidate>
                    <div class="mb3">
                        <label for="name" class="form-label">Masukkan Nama </label>
                        <input type="text" class="form-control" id="nama" placeholder="Nama Lengkap Kamu" required>
                    </div>
                    <div class="mb-3">
                        <label for="alamat" class="form-label">Alamat Lengkap</label>
                        <textarea id="alamat" class="form-control" rows="2" placeholder="Masukkan alamat lengkap"
                            required></textarea>
                    </div>
                    <div class="mb-3">
                        <label for="telepon" class="form-label">Nomor Telepon</label>
                        <div class="input-group">
                            <span class="input-group-text">+62</span>
                            <input type="text" id="telepon" class="form-control" placeholder="85766243578"
                                maxlength="11" pattern="\d{11}" required>
                        </div>
                        <small class="text-muted">Masukkan 11 angka setelah +62 (contoh: 81234567890)</small>
                    </div>
                    <div class="d-flex justify-content-center mt-4 gap-2">
                        <button type="button" class="btn btn-secondary" onclick="cancelCheckout()">Batal</button>
                        <button type="submit" class="btn btn-success">Checkout Sekarang</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div class="position-fixed top-0 end-0 p-3" style="z-index: 1055 ">
        <div id="succesToast" class="toast align-items-center text-white bg-success border-0" role="alert">
            <div class="d-flex">
                <div class="toast-body">Terimakasih sudah Berbelanja di Toko Kami</div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>


    <script>
        let cart = JSON.parse(localStorage.getItem("checkoutCart")) || [];
        function loadCheckoutData() {
            const cartContainer = document.getElementById("cartSummary");
            const totalEl = document.getElementById("checkoutTotal");

            if (cart.length === 0) {
                cartContainer.innerHTML = "<p>Keranjang kosong.</p>";
                totalEl.innerText = "0";
                return;
            }

            let total = 0;
            cartContainer.innerHTML = "";
            cart.forEach(item => {
                const price = Number(item.price);
                const quantity = Number(item.qty);
                const subtotal = price * quantity;
                total += subtotal;
                cartContainer.innerHTML += `
        <div class="cart-item">
            <img src="${item.img}" alt="${item.name}">
            <div>
                <strong>${item.name}</strong><br>
                Jumlah: ${quantity}<br>
                Harga : Rp ${price.toLocaleString("id-ID")}
            </div>
        </div> `;
            });

            totalEl.innerText = total.toLocaleString("id-ID");
        }

        function submitCheckout(event) {
            event.preventDefault();

            const form = document.getElementById("checkoutForm");

            // Validasi form
            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }

            //ambil data pembeli
            const nama = document.getElementById("nama").value.trim();
            const alamat = document.getElementById("alamat").value.trim();
            const telepon = document.getElementById("telepon").value.trim();
            const total = document.getElementById("checkoutTotal").innerText;


            //konfirmasi sebeleum submit
            const konfirmasi = confirm(
                `Periksa kembali data pesananmu:\n\n` +
                `Nama: ${nama}\n` +
                `Alamat: ${alamat}\n` +
                `Nomor Telepon: +62${telepon}\n` +
                `Total Pembayaran: Rp ${total}\n\n` +
                `Apakah data sudah benar?`
            );

            //batal, jika tekan cancel
            if (!konfirmasi) return;

            //tampilkan toast sukses
            const toastEl = document.getElementById("succesToast");
            const toast = new bootstrap.Toast(toastEl);
            toast.show();

            //bersihkan keranjang
            localStorage.removeItem("checkoutCart");
            cart = [];

            //kembali ke beearanda setelah co
            setTimeout(() => {
                window.location.href = "index.html";
            }, 3000);
        }

        function cancelCheckout() {
            const confirmcancel = confirm("Apakah kamu yakin ingin membatalkan checkout?");
            if (confirmcancel) {
                window.location.href = "produk.html";
            }
        }

        loadCheckoutData();
    </script>
</body>

</html>